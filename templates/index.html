<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
    <link rel="stylesheet" href="./styles.css"/>
    <title>Anime Recommendation System</title>
    <style>
	 #animeContainer {
		display: flex;
		flex-wrap: wrap;
		justify-content: space-between;
		margin-top: 40px;
	    }
        .animeCard {
            @apply relative bg-gray-800 border border-gray-700 rounded-md p-4 m-4 text-center transition-all duration-300 hover:shadow-xl cursor-pointer;
            width: 48%; /* Adjust width as needed */
        }

        .animeCard img {
            @apply w-full mb-4 transition-transform hover:scale-110;
        }
	
    </style>
    <style>
	/* GLOBAL VARIABLES */
	:root {
	  --font: "Roboto", sans-serif;
	  --fontOrigin: 1rem;     /* 16px */
	  --fontSmall: 0.625em;   /* 10px */
	  --fontMedium: 0.875em;  /* 14px */
	  --fontNormal: 1em;      /* 16px */
	  --fontLarge:  1.375em;  /* 22px */
	  --fontLight: 100;
	  --fontRegular: 400;
	  --speed: 0.65s;
	}

	@keyframes zoom {
	  from {
	    object-position: 0 50%;
	  }
	  to {
	    object-position: 100% 50%;
	  }
	}

	@keyframes blur {
	  from {
	    -webkit-transform: scale(1, 1);
	    transform: scale(1, 1);
	  }
	  to {
	    -webkit-transform: scale(1.5, 1.5);
	    transform: scale(2, 2);
	  }
	}

	* {
	  border: 0;
	  margin: 0;
	  padding: 0;
	  box-sizing: border-box;
	}

	body {
	  font-family: var(--font);
	  font-weight: var(--fontOrigin);
	  font-size: 1rem;
	  line-height: 1.2;
	  letter-spacing: 0.005rem;
	  -webkit-font-smoothing: subpixel-antialiased;
	  font-smoothing: subpixel-antialiased;
	}

	.wrapper {
	  display: grid;
	  grid-template-columns: repeat( auto-fit, 1fr );
	  grid-template-rows: auto;
	  grid-template-areas:
	    "menu menu menu"
	    ". card .";
	  width: 100vw;
	  min-height: 100vh;
	  padding-top: 40px;
	  padding-bottom: 40px;
	}

	.menu {
	  grid-area: menu;
	  align-self: end;
	}

	.menu__list {
	  text-align: center;
	}

	.menu__item {
	  position: relative;
	  display: inline-block;
	  padding: 10px 20px;
	  font-size: var(--fontMedium);
	  font-weight: var(--fontRegular);
	  text-transform: uppercase;
	  color: #a9a9a9;
	  cursor: pointer;
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	}

	.menu__item::after {
	  content: "";
	  display: block;
	  width: 0;
	  height: 2px;
	  margin-top: 6px;
	  background: rgba(100, 100, 250, 1);
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	}

	.menu__item:hover {
	  color: rgba(150, 150, 255, 1);
	}
	.menu__item.active {
	  color: rgba(100, 100, 250, 1);
	}

	.menu__item.active::after {
	  width: 100%;
	}

	.card {
	  position: relative;
	  grid-area: card;
	  align-self: center;
	  justify-self: center;
	  overflow: hidden;
	  display: block;
	  width: 100%;
	  max-width: 250px;
	  height: 400px;
	  margin: 25px 25px 25px 25px;
	  font-size: var(--fontOrigin);
	  border-radius: 8px;
	  box-shadow: 0 16px 60px rgba(0, 0, 0, 0.3);
	  cursor: pointer;
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	}

	.card:hover {
	  box-shadow: 0 40px 130px rgba(0, 0, 0, 0.6);
	  -webkit-transform: scale(1.1, 1.1);
	  transform: scale(1.1, 1.1);
	}

	.card__save {
	  position: absolute;
	  top: 10px;
	  right: 10px;
	  display: block;
	  width: 35px;
	  height: 35px;
	  background: transparent;
	  border: 0;
	  opacity: 0;
	  border-radius: 3px;
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	}

	.card__save:focus {
	  outline: 0;
	  background-color: rgba(255, 255, 255, 0);
	}

	.card:hover .card__save {
	  opacity: 0.6;
	}

	.card__save i {
	  font-size: 18px;
	  color: rgba(255, 255, 255, 0.6);
	  cursor: pointer;
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	}

	.card__save:hover i {
	  color: rgba(255, 255, 255, 0.8);
	}

	.card__save:active,
	.card__save.active {
	  opacity: 1 !important;
	}

	.card__save:active i,
	.card__save.active i {
	  color: white;
	}

	.card__image {
	  position: absolute;
	  top: 0;
	  left: 0;
	  z-index: -1;
	  overflow: hidden;
	  display: block;
	  width: 100%;
	  height: 100%;
	  pointer-events: none;
	  background: linear-gradient(to bottom, rgba(0, 0, 0, 1), rgba(0, 0, 0, 0.5));
	}

	.card__image img {
	  -webkit-transform: scale(1.3, 1.3);
	  transform: scale(1.3, 1.3);
	  display: block;
	  width: 100%;
	  height: 100%;
	  object-fit: cover;
	  opacity: 1;
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	  animation-name: zoom;
	  animation-duration: 30s;
	  animation-direction: alternate;
	  animation-timing-function: linear;
	  animation-iteration-count: infinite;
	}

	.card:hover .card__image img {
	  -webkit-transform: scale(1, 1);
	  transform: scale(1, 1);
	  opacity: 0.5;
	}

	.card__header {
	  display: grid;
	  width: 100%;
	  height: 200px;
	}

	.card__profile {
	  align-self: center;
	  justify-self: center;
	  display: block;
	  overflow: hidden;
	  width: 10vmax;
	  height: 10vmax;
	  max-width: 100px;
	  max-height: 100px;
	  border-radius: 50%;
	}

	.card__profile img {
	  -webkit-transform: scale(1.5, 1.5)  translateZ(0);
	  transform: scale(1.5, 1.5)  translateZ(0);
	  display: block;
	  width: 100%;
	  height: 100%;
	  object-fit: cover;
	  object-position: 50% 50%;
	  -webkit-filter: grayscale(50%) contrast(75%) brightness(1.3);
	  filter: grayscale(50%) contrast(75%) brightness(1.3);
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	  mix-blend-mode: normal;
	  -webkit-backface-visibility: hidden;
	  backface-visibility: hidden;
	}

	.card:hover .card__profile img {
	  -webkit-transform: scale(1, 1)  translateZ(0);
	  transform: scale(1, 1)  translateZ(0);
	}

	.card__body {
	  display: grid;
	  padding: 0 20px;
	}

	.card__name {
	  align-self: center;
	  justify-self: center;
	  margin-bottom: 2px;
	  color: white;
	  font-size: var(--fontLarge);
	  font-weight: var(--fontLight);
	  letter-spacing: 0.1rem;
	  text-align: center;
	  text-transform: uppercase;
	  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.35);
	  background: -webkit-linear-gradient(white, #a1a1a1);
	  -webkit-background-clip: text;
	  -webkit-text-fill-color: transparent;
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	}

	.card:hover .card__name {
	  background: -webkit-linear-gradient(white, #c1c1c1);
	  -webkit-background-clip: text;
	  -webkit-text-fill-color: transparent;
	}

	.card__job {
	  align-self: center;
	  justify-self: center;
	  display: inline-block;
	  font-size: var(--fontSmall);
	  font-weight: var(--fontLight);
	  text-align: center;
	  letter-spacing: 0.35rem;
	  color: rgba(100, 130, 200, 0.45);
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	}

	.card:hover .card__job {
	  color: rgba(100, 130, 200, 1);
	}

	.card__bio {
	  position: relative;
	  -webkit-transform: translateY(30%);
	  transform: translateY(30%);
	  display: block;
	  margin: 22px 0 16px 0;
	  font-size: var(--fontMedium);
	  font-weight: var(--fontLight);
	  /*text-shadow: 0 0.5px 1px rgba(0, 0, 0, 0.35);*/
	  color: rgba(255, 255, 255, 0.65);
	  opacity: 0;
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	}

	.card:hover .card__bio {
	  -webkit-transform: translateY(0);
	  transform: translateY(0);
	  opacity: 1;
	}

	.card__footer {
	  position: relative;
	  -webkit-transform: translateY(60%);
	  transform: translateY(60%);
	  display: grid;
	  grid-template-columns: repeat(2, 1fr);
	  grid-template-areas: "date category";
	  padding: 10px 20px;
	  opacity: 0;
	  -webkit-transition: all var(--speed) ease;
	  transition: all var(--speed) ease;
	}

	.card:hover .card__footer {
	  -webkit-transform: translateY(0);
	  transform: translateY(0);
	  opacity: 1;
	}

	.card__date {
	  grid-area: date;
	  display: inline-block;
	  align-self: left;
	  justify-self: left;
	  font-size: var(--fontSmall);
	  font-weight: var(--fontLight);
	  text-transform: uppercase;
	  text-shadow: 0 0.5px 1px rgba(0, 0, 0, 0.45);
	  color: rgba(250, 250, 250, 0.4);
	}

	/* MODIFIERS */
	.card[data-effect="blur"]:hover .card__image img {
	  -webkit-filter: blur(3px);
	  filter: blur(3px);
	}

	.card[data-effect="blur"] .card__image img {
	  animation-name: blur;
	}

	.card[data-effect="color"]:hover {
	  -webkit-transform: scale(1, 1);
	  transform: scale(1, 1);
	  box-shadow: 0 40px 260px rgba(255, 0, 0, 0.1), 0 40px 130px rgba(250, 100, 100, 0.2), -80px -40px 230px rgba(0, 200, 250, 0.15), 80px 40px 230px rgba(120, 120, 255, 0.15);
	}

	.card[data-effect="color"] .card__image {
	  background: linear-gradient(to bottom, rgba(20, 20, 100, 1), rgba(255, 100, 100, 0.5))
	}

	.card[data-effect="color"]:hover .card__image img {
	  opacity: 0.8;
	}

	.card[data-effect="color"]:hover .card__profile img {
	  -webkit-filter: grayscale(50%) contrast(80%) brightness(1.6);
	  filter: grayscale(50%) contrast(80%) brightness(1.6);
	  mix-blend-mode: normal;
	}
    </style>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}"/>
</head>
<body class="font-sans bg-gray-900 text-white transition-colors duration-500">
    <header class="bg-gray-800 p-5 text-center shadow-md relative z-10 transition-all duration-500">
        <h1 class="m-0 text-2xl">Anime Recommendation App</h1>
        <div id="toggleMode" onclick="toggleMode()" data-mode="dark" class="absolute top-5 right-5 cursor-pointer transition-transform duration-300 hover:scale-125">
            ☀️
        </div>
    </header>

    <div class="search-container bg-gray-800 p-2 text-center w-1/2 mx-auto mt-8 transition-transform duration-300 transform-gpu hover:scale-105" focus:scale-105>
        <form id="searchForm" onsubmit="return false;" class="relative text-gray-600 focus-within:text-gray-400">
            <div class="flex items-center">
                <span class="absolute inset-y-0 left-0 flex items-center pl-2">
                    <button onclick="applySearch()" class="p-1 focus:outline-none focus:shadow-outline">
                        <svg fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" class="w-6 h-6">
                            <path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </button>
                </span>
                <input type="text" id="searchInput" class="flex-auto py-2 text-sm text-white bg-gray-900 rounded-md pl-10 pr-2 focus:outline-none focus:text-white focus-gradient-border w-full text-center">
            </div>
        </form>
    </div>
    <!--<div class="card" data-effect="zoom">
    <button class="card__save  js-save" type="button">
      <i class="fa  fa-bookmark"></i>
     </button>
    <figure  class="card__image">
      <img src="https://c1.staticflickr.com/4/3935/32253842574_d3d449ab86_c.jpg" alt="Short description">
    </figure>
    <div class="card__header">
      <figure class="card__profile">
        <img src="https://upload.wikimedia.org/wikipedia/commons/1/1c/Neil_Armstrong.jpg" alt="Short description">
      </figure>
    </div>
    <div class="card__body">
      <h3 class="card__name">Neil Armstrong</h3>
      <p class="card__job">astronaut & engineer</p>
      <p class="card__bio"> American astronaut, engineer, and the first person to walk on the Moon.</p>
    </div>
    <div class="card__footer">
      <p class="card__date">Feb 10 2018</p>
      <p class=""></p>
    </div>
  </div>-->
    <div id="animeContainer" class="overflow-hidden">
        <!-- Anime cards will be dynamically added here -->
    </div>
    <div id="pagination" class="content_detail__pagination cdp"></div>

    <div id="animeDetails" class="hidden mt-20">
        <div id="animeDetailsContainer" class="text-left">
            <h2 class="text-xl font-bold mb-4">Anime Details</h2>
            <!-- ... (rest of your content) -->
        </div>

        <div id="recommendations" class="mt-10">
            <h3 class="text-lg font-bold">Recommendations</h3>
            <ul id="recommendationList" class="list-disc pl-5"></ul>
        </div>
    </div>

    <script>
        let animeData = {{ anime_data|tojson }};
	let currentPage = 1;
	    const resultsPerPage = 12;
	    let filteredAnimeData = animeData;

	    // Display initial anime cards
	    displayAnime(1);
	    function createAnimeCard(anime) {
		    const card = document.createElement('div');
		    card.className = 'card';
		    card.dataset.effect = 'blur';

		    const saveButton = document.createElement('button');
		    saveButton.className = 'card__save js-save';
		    saveButton.type = 'button';

		    const bookmarkIcon = document.createElement('i');
		    bookmarkIcon.className = 'fa fa-bookmark';

		    saveButton.appendChild(bookmarkIcon);
		    card.appendChild(saveButton);

		    const cardImage = document.createElement('figure');
		    cardImage.className = 'card__image';

		    const img = document.createElement('img');
		    img.src = anime.img_url; // Provide the image URL from your anime data
		    img.alt="Short Description";
		    
		    cardImage.appendChild(img);
		    card.appendChild(cardImage);

		    const cardBody = document.createElement('div');
		    cardBody.className = 'card__body';

		    const h3 = document.createElement('h3');
		    h3.className = 'card__name';
		    h3.textContent = anime.title;

		    const jobParagraph = document.createElement('p');
		    jobParagraph.className = 'card__job';
		    jobParagraph.textContent = anime.score; // Provide the job information from your anime data

		    const bioParagraph = document.createElement('p');
		    bioParagraph.className = 'card__bio';
		    bioParagraph.textContent = anime.synopsis; // Provide the bio information from your anime data

		    cardBody.appendChild(h3);
		    cardBody.appendChild(jobParagraph);
		    cardBody.appendChild(bioParagraph);
		    card.appendChild(cardBody);

		    const cardFooter = document.createElement('div');
		    cardFooter.className = 'card__footer';

		    const dateParagraph = document.createElement('p');
		    dateParagraph.className = 'card__date';
		    dateParagraph.textContent = anime.aired; // Provide the date information from your anime data

		    cardFooter.appendChild(dateParagraph);
		    card.appendChild(cardFooter);
		    card.addEventListener('click', () => showDetails(anime));
		    return card;
		}





	    function showDetails(anime) {
		window.location.href = `/anime_details?uid=${anime.uid}&title=${encodeURIComponent(anime.title)}`;
	    }

	    function updatePagination() {
		    const paginationContainer = document.getElementById('pagination');
		    paginationContainer.innerHTML = '';

		    const totalPages = Math.ceil(filteredAnimeData.length / resultsPerPage);
		    createPaginationButton('prev', 'Prev', currentPage > 1);

		    if (totalPages <= 9) {
			// Display all pages
			for (let i = 1; i <= totalPages; i++) {
			    createPaginationButton(i,i, true);
			}
		    } else {
			// Display custom pagination with ellipsis
			if (currentPage <= 5) {
			    // Display first six pages
			    for (let i = 1; i <= 6; i++) {
				createPaginationButton(i,i, true);
			    }
			    createEllipsis();
			} else if (currentPage >= totalPages - 4) {
			    // Display ellipsis and the last six pages
			    createEllipsis();
			    for (let i = totalPages - 5; i <= totalPages; i++) {
				createPaginationButton(i,i, true);
			    }
			} else {
			    // Display ellipsis, current page, and surrounding pages
			    createEllipsis();
			    for (let i = currentPage - 2; i <= currentPage + 2; i++) {
				createPaginationButton(i,i, true);
			    }
			    createEllipsis();
			}
		    }

		    createPaginationButton('next', 'Next', currentPage < totalPages);
		}

		function createPaginationButton(page, label, isEnabled) {
		    const button = document.createElement('a');
		    button.textContent = label;
		    button.className = "cdp_i";
		    if (page === 'prev') {
			button.addEventListener('click', () => handlePrevious());
		    } else if (page === 'next') {
			button.addEventListener('click', () => handleNext());
		    } else {
			button.addEventListener('click', () => handlePageClick(page));
		    }

		    if (page===currentPage) {
			button.classList.add('active');
			}
		    if (!isEnabled){
			button.classList.add('disabled');
		    }

		    document.getElementById('pagination').appendChild(button);
		}

		function handlePageClick(page) {
		    currentPage = page;
		    displayAnime(page);
		    updatePagination();
		}

		function handlePrevious() {
		    if (currentPage > 1) {
			currentPage--;
			displayAnime(currentPage);
			updatePagination();
		    }
		}

		function handleNext() {
		    const totalPages = Math.ceil(filteredAnimeData.length / resultsPerPage);
		    if (currentPage < totalPages) {
			currentPage++;
			displayAnime(currentPage);
			updatePagination();
		    }
		}

		function createEllipsis() {
		    const ellipsis = document.createElement('span');
		    ellipsis.className = 'ellipsis';
		    ellipsis.textContent = '...';
		    document.getElementById('pagination').appendChild(ellipsis);
		}


	function displayAnime(page) {
	    const animeContainer = document.getElementById('animeContainer');
	    animeContainer.innerHTML = '';

	    const startIdx = (page - 1) * resultsPerPage;
	    const endIdx = startIdx + resultsPerPage;

	    const currentAnimePage = filteredAnimeData.slice(startIdx, endIdx);

	    currentAnimePage.forEach(anime => {
		const card = createAnimeCard(anime);
		animeContainer.appendChild(card);
	    });
	    updatePagination();
	}

	// Example usage:
	// Call updatePagination initially to set up the pagination
	updatePagination();
        function applySearch() {
            const searchInput = document.getElementById('searchInput').value.trim().toLowerCase();
            filteredAnimeData = animeData.filter(anime =>
                anime.title.toLowerCase().includes(searchInput)
            );
            displayAnime(1);
        }
    </script>
</body>
</html>

